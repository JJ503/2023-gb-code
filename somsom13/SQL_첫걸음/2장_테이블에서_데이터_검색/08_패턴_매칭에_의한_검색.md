### 8강. 패턴 매칭에 의한 검색

**LIKE 술어를 사용하면 문자열의 일부분을 비교하는 “부분 검색”이 가능하다.**

`열 LIKE 검색할 패턴`

- `=` 연산자로 `text = 'SQL'` 로 검색하면, 완전히 일치하는 값만 반환
- `LIKE` 연산자로 `text LIKE '%SQL%'` 로 검색하면, text에 SQL이라는 문자가 포함된 값을 반환
- **패턴 매칭, 또는 부분 검색** 이라고 부른다

**1. LIKE로 패턴 매칭하기**

- LIKE술어: 열 값이 부분적으로 일치하는 경우 참이 된다.
- `매칭 대상이 되는 열 LIKE 검색할 문자열 패턴` (이항 연산자처럼 항목 지정)
    - **수치형 상수는 지정할 수 없다**
    - `%_` : 패턴 정의 시, **메타문자** 사용 가능
        - **와일드카드**라고도 불린다.
        - 임의의 문자, 또는 문자열에 매치하는 부분을 지정하기 위해 쓰는 특수 문자
        - `%`: **임의의 문자열**
        - `_` (언더스코어): 임의의 **문자** **하나**
    - 메타 문자를 LIKE 패턴에 사용하지 않아도 되지만, 그러면 완전히 일치하는 값이 검색되기 때문에 LIKE 검색의 의미가 없다.
        - ex) `WHERE text LIKE 'SQL'` → 메타 문자 사용X
        - 그러면 `text = 'SQL'` 과 동일한 효과가 된다.
    - **`*` 메타문자는 LIKE에서는 사용할 수 없다.**

- 예시

![image](https://user-images.githubusercontent.com/70891072/233820204-35288462-6082-429e-90fb-b53e1e35e947.png)

- `WHERE text LIKE 'SQL%'`
    - text의 값이 “SQL어쩌구저쩌구” 인 필드를 모두 조회한다.
    - 즉, text 문자열이 SQL로 시작하는 모든 데이터 조회
    - 1번만 조회된다.
    - **문자열 앞쪽에 지정한 문자와 일치하는 경우 ⇒ “전방 일치”**
- `WHERE text LIKE '%SQL%'`
    - text에 “SQL” 이라는 문자열이 포함된 필드를 모두 조회한다.
    - 1번, 3번이 조회된다.
    - **`%` 메타문자는 빈 문자열과도 매치한다!!!**
        - 그래서 SQL앞에 아무것도 없는 1번도 빈 문자열로 매치되어 조회되는 것
    - **문자열 중간에 지정한 문자와 일치하는 경우 ⇒ “중간 일치”**
- `WHERE text LIKE '%SQL'`
    - text가 “어쩌구SQL” 인 필드를 모두 조회한다.
    - 즉, 값이 “SQL”로 끝나야 함
    - **문자열이 끝에 지정한 문자와 일치 ⇒ “후방 일치”**

**2. LIKE로 %를 검색하기**

‘%’는 메타문자로 처리가 된다. 만약 진짜 문자열 ‘%’ 를 검색하고 싶다면?

- **이스케이프** 라는 방법으로 처리할 수 있다.
    - `\%` 와 같이 앞에 `\` 를 붙인다.
    - `WHERE text LIKE '%\%%'`
        - %가 있는 문자열을 모두 검색 (중간 일치)
        - 맨 앞의 `%` : 메타문자 → 앞에 어떤 문자열이라도 올 수 있음
        - 가운데의 `\%` : 이스케이프 된 % 의미 → 실제로 문자열 중 %를 찾음
        - 맨 뒤의 `%` : 메타문자 → 찾는 문자열 뒤에 어떤 문자열이라도 올 수 있음
        - “메타 문자는 %와 _가 있다” 라는 필드를 가진 데이터가 조회된다.
    - `_` 검색 시에도 `\_` 사용

**3. 문자열 상수 ‘의 이스케이프**

문자열 상수 (`’` → 싱글쿼트 의미)를 “문자 그 자체로” 검색할 때도 메타문자와 같은 문제가 생긴다. 

- `''` 와 같이 `'` 를 연속해서 쓰는 것으로 이스케이프 처리 가능!
    - ex) ‘It’s’ 라는 문자열 검색 → 안에 `'` 를 포함함
        - ‘It’’s’ 로 표기!
    - ex) 정말 ‘ 하나만 검색
        - ‘’’’ 로 표기!
        - 맨 앞의 `'` : 상수 문자열 시작 싱글 쿼트
        - 가운데의 `''` : 이스케이프된 ‘ 문자열
        - 맨 뒤의 `'` : 상수 문자열 종료 싱글 쿼트

> 간단한 패턴 매칭은 LIKE로 충분하지만, 복잡한 검색 시에는 정규 표현식 (Regular Expression) 을 사용하는 것이 더 낫다.
