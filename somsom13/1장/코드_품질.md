# 1장 코드  품질

----

**고품질 코드**: 더 신뢰할 수 있고, 유지보수가 쉬우며 버그가 적은 소프트웨어를 생산한다. 
> 요구사항 만족도가 높으며, 예상치 못한 상황에 대한 대응이 잘 되어있기 때문

## 1. 코드가 하나의 소프트웨어가 되기 까지의 개발 프로세스

**소프트웨어 개발 및 배포 프로세스**: 코드 작성 → 의도한 대로 동작하고, 기존의 기능이 여전히 잘 동작하는지 검증 및 점검

- 코드베이스: 소프트웨어를 빌드할 수 있는 코드가 저장된 저장소 (version control 에 의해 관리)
- 코드 제출: commit / merge
- 코드 리뷰 (코드 검토) : 다른 엔지니어의 코드를 코드베이스에 제출하기 전에 검토하는 것
- 제출 전 검사 (pre-commit / merge check): 테스트에 실패하거나 컴파일 오류가 있는 코드가 병합되는 것을 차단
- 배포: 코드베이스의 snapshot 을 기반으로 빌드 (특정 버전을 가져와 배포하는 프로세스 == 배포 브랜치 만들기)
- 프로덕션: 소프트웨어가 실제 서비스 되는 환경 (출시 후, 비즈니스 관련 작업을 수행)

> 보통 배포는 코드베이스에서 주기적으로 이루어짐 (주기는 팀원들과 협의)

## 2. 코드 품질의 목표: 더 나은 소프트웨어를 만드는 것

**고품질 코드 / 저품질 코드를 판단하는 기준**: “이 코드가 목표를 달성하는데 도움이 되는가” 를 생각하는 것

### 코드 작성 시의 목표

- 작성한대로 동작해야 한다. (1차적인 목표)
  - 우리가 작성한 코드는 코드를 작성하게 된 문제를 해결할 수 있어야 한다
  > 작동한다: 해당 코드를 작성하게 된 이유에 부합하게 동작한다. (즉 문제를 해결한다)
- 작동이 멈춰서는 안된다
  - 주변 상황, 또는 요구 사항이 변화해서 코드의 작동이 멈출 수 있다. 그건 유용한 코드가 아니다
- 변화하는 요구 사항에 적응해야 한다. → 한 번 작성되고 수정되지 않는 코드는 거의 없다.
  - 요구 사항이 변화할 수 있다는 사실을 언제나 염두에 두어야 한다. (적응성이 높은 코드를 작성해야 한다)
- 이미 존재하는 기능을 또다시 구현해서는 안된다 → 이미 구현된 코드 (라이브러리, API) 를 재사용하자
  - 코드 재사용의 장점
    1. 시간과 노력 절약
    2. 버그 가능성 감소: 이미 구현된 어떤 기능이 있다면, 그건 이미 충분한 테스트를 거쳤을 것! + 버그가 있었어도 실사용 중에 해결되었을 가능성이 높다
    3. 기존 전문 지식 활용
    4. 코드가 이해하기 쉽다: 표준화 된 방식으로 코드를 작성하면, 다른 개발자들이 해당 코드를 이해하는데 도움이 될 것이다
- 문제에 대한 해결책 코드가 이미 작성되어 있다면, 이를 활용해야 한다
- 문제에 대한 해결책 코드를 내가 처음 작성할 경우, 다른 사람들이 이를 잘 활용할 수 있도록 작성해야 한다.

## 3. 코드 품질의 핵심적인 6가지 요소

1. 읽기 쉬워야 한다. **코드 가독성이 좋아야 한다**
   - 코드로부터 파악 해야 할 것들
       - 코드가 하는 일
       - 어떻게 수행하는가
       - 어떤 것 (입력, 상태 등) 을 필요로 하는가
       - 실행 결과물
   - 코드 가독성이 떨어지면 발생하는 어려움
       - 다른 개발자들이 코드를 이해하는데 오랜 시간이 소모된다.
       - 코드를 잘못 이해하거나, 세부 사항을 놓치게 될 수 있다 → 코드 리뷰 과정에서 버그를 찾기가 어려워지고 다른 개발자가 기능을 추가할 때 버그가 생길 가능성이 커진다
       - **제대로 이해되지 않는 코드로 작성된 소프트웨어가 제대로 동작하기는 어렵다**
2. 예측 가능해야 한다
    - 코드가 개발자의 초기 의도에서 벗어난, 전혀 다른 일을 수행하여 잘못된 결과를 불러올 수도 있다.
3. 오용하기 어렵게 만들어야 한다
    - 자신이 작성한 메서드가 잘못된 곳에서 호출되는 등, 오용 된다면 소프트웨어의 동작 자체에 문제가 생길 수 있다.
4. 코드를 모듈화 해야한다
    - **모듈화: 개체나 시스템의 구성 요소가 독립적으로 교환되거나 교체될 수 있음**
    - 모듈화 된 시스템: 인터페이스가 잘 정의되어서 서로 다른 구성 요소간에 상호작용하는 지점이 최소화 된다.
      ex) 로봇: 팔, 다리를 연결하는 못과 그 구멍이라는 간단한 인터페이스를 통해 상호작용
      봉재인형: 실로 연결되어 있기 때문에 복잡하다
    - 잘 분리된 두 모듈 사이의 상호작용은 인터페이스를 통해서 이루어지기 때문에 유지보수가 용이하다.
5. 코드를 재사용 가능하고, 일반화 할 수 있게 작성하라
    - 재사용성: 어떤 문제를 해결하기 위한 무언가가, 다른 상황에도 사용될 수 있는 것
    - 일반화성: 개념적으로는 유사하지만 서로 미묘하게 다른 문제를 해결할 수 있음
6. 테스트가 용이한 코드를 작성하고, 제대로 테스트 해라
    - 테스트: 버그를 가지고 있거나, 제대로 동작하지 않는 코드가 실제 서비스에서 실행되는 것을 막을 수 있다
    - **테스트: 코드 또는 SW 전체를 테스트. 수동 or 자동**
        - 단위 테스트: 개별 메서드, 클래스 단위의 작은 단위를 테스트 (가장 자주 다룸)
        - 통합 테스트: 통합 테스트로 연결된 구성 요소들이 제대로 동작하는 것을 확인
        - 종단간(E2E) 테스트: 처음~끝의 전체 시스템 흐름을 테스트
    - 테스트 용이성: 테스트의 대상인 “실제” 코드. **해당 코드가 테스트하기에 얼마나 적합한가**
        - 모듈화 된 코드는 테스트 용이성이 더 좋다.
        - **작성 중인 코드의 테스트 용이성을 파악하기 위해서는, 작성하는 과정에서 ‘어떻게 테스트 하지?’ 를 계속해서 생각해라!** (작성하고 생각하는 것은 늦다)


## 4. 고품질 코드 작성은 일정을 지연시키는가

일반적인 개발보다 생각의 시간이 더 길어지기 때문에, 단기적으로는 일정이 지연되는 듯 보인다. 
<br> 하지만 장기적으로는 개발 시간을 단축해준다! (나중에 유지보수나 기능 추가를 할 때 소모되는 과정, 시간이 단축되므로)
<br> 단기간에 작성한 코드는 머지않아 취약하고 복잡한 코드로 이어진다.